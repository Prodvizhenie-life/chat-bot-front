{
  "flowName": "Main",
  "version": "1.0.4",
  "categories": [
    {
      "id": "general",
      "label": "Общая информация",
      "order": 1,
      "description": "Общие данные о подопечном"
    },
    {
      "id": "details",
      "label": "Подробная информация",
      "order": 2,
      "description": "Информация о диагнозе, состоянии, сроках"
    },
    {
      "id": "documents",
      "label": "Документы",
      "order": 3,
      "description": "Паспорт, мед. заключения и прочие документы"
    }
  ],
  "startStep": "autosave",
  "steps": [
    {
      "id": "autosave",
      "type": "info",
      "category": "general",
      "image": "/images/main/autosave.png",
      "text": "Данные сохраняются автоматически. Вы можете выйти и в любой момент вернуться к заполнению анкеты",
      "actions": [
        {
          "label": "Заполнить анкету",
          "action": "fill_the_questionnaire",
          "className": "btn btn-primary",
          "next": "what_needed"
        }
      ]
    },
    {
      "id": "what_needed",
      "type": "select",
      "category": "general",
      "text": "Что нужно приобрести?",
      "options": [
        { "label": "Коляска (ТСР)", "value": "kolyaska", "next": "who_fills" },
        { "label": "Приставка", "value": "pristavka", "next": "who_fills" },
        { "label": "Комплектующие", "value": "komplekt", "next": "who_fills" },
        { "label": "Иное TCP", "value": "other_tcp", "next": "other_tcp" }
      ]
    },
    {
      "id": "other_tcp",
      "type": "textarea",
      "category": "general",
      "text": "Расскажите, что именно вам нужно",
      "label": "",
      "required": false,
      "next": "who_fills"
    },
    {
      "id": "who_fills",
      "type": "select",
      "category": "general",
      "text": "Кто заполняет заявку?",
      "options": [
        { "label": "Мать / Отец / Опекун / Родственник", "value": "parent", "next": "ward_fio" },
        { "label": "Я есть подопечный", "value": "self", "next": "applicant_fio" }
      ]
    },

    {
      "id": "ward_fio",
      "type": "input",
      "category": "general",
      "inputType": "fio",
      "text": "Введите ФИО подопечного",
      "placeholder": "ФИО подопечного",
      "required": true,
      "next": "ward_birthdate"
    },
    {
      "id": "ward_birthdate",
      "type": "input",
      "category": "general",
      "inputType": "date",
      "text": "Дата рождения подопечного",
      "placeholder": "ДД.ММ.ГГГГ",
      "required": true,
      "next": "ward_city"
    },
    {
      "id": "ward_city",
      "type": "input",
      "category": "general",
      "inputType": "city",
      "text": "Город проживания подопечного",
      "required": true,
      "next": "ward_phone"
    },
    {
      "id": "ward_phone",
      "type": "input",
      "category": "general",
      "inputType": "phone",
      "text": "Телефон подопечного (если есть)",
      "placeholder": "+7 ХХХ ХХХ-ХХ-ХХ",
      "required": false,
      "next": "ward_illness"
    },
    {
      "id": "ward_illness",
      "type": "input",
      "category": "details",
      "inputType": "text",
      "text": "Диагноз подопечного",
      "placeholder": "Диагноз",
      "required": true,
      "next": "ward_state"
    },
    {
      "id": "ward_state",
      "type": "textarea",
      "category": "details",
      "text": "Опишите состояние здоровья подопечного и ограничения",
      "required": false,
      "next": "ward_diagnosis_date"
    },
    {
      "id": "ward_diagnosis_date",
      "type": "input",
      "category": "details",
      "inputType": "date",
      "text": "Когда был поставлен диагноз подопечному?",
      "required": false,
      "next": "ward_tsr"
    },
    {
      "id": "ward_tsr",
      "type": "select",
      "category": "details",
      "text": "Прописано ли ТСР в медзаключении или ИПРА?",
      "options": [
        { "label": "Прописано", "value": "yes", "next": "ward_deadline" },
        { "label": "Не прописано", "value": "no", "next": "ward_deadline" }
      ]
    },
    {
      "id": "ward_deadline",
      "type": "input",
      "category": "details",
      "inputType": "text",
      "text": "Есть ли сроки, к которым важно получить помощь?",
      "required": false,
      "next": "applicant_fio_parent"
    },
    {
      "id": "applicant_fio_parent",
      "type": "input",
      "category": "general",
      "inputType": "fio",
      "text": "Введите ваше ФИО (заявителя)",
      "placeholder": "Ваше ФИО",
      "required": true,
      "next": "applicant_phone_parent"
    },
    {
      "id": "applicant_phone_parent",
      "type": "input",
      "category": "general",
      "inputType": "phone",
      "text": "Ваш номер телефона",
      "placeholder": "+7 ХХХ ХХХ-ХХ-ХХ",
      "required": true,
      "next": "prepare_documents"
    },

    {
      "id": "applicant_fio",
      "type": "input",
      "category": "general",
      "inputType": "fio",
      "text": "Введите ваше ФИО",
      "placeholder": "Ваше ФИО",
      "required": true,
      "next": "applicant_birthdate"
    },
    {
      "id": "applicant_birthdate",
      "type": "input",
      "category": "general",
      "inputType": "date",
      "text": "Ваша дата рождения",
      "placeholder": "ДД.ММ.ГГГГ",
      "required": true,
      "next": "applicant_city"
    },
    {
      "id": "applicant_city",
      "type": "input",
      "category": "general",
      "inputType": "city",
      "text": "Ваш город проживания",
      "required": true,
      "next": "applicant_phone"
    },
    {
      "id": "applicant_phone",
      "type": "input",
      "category": "general",
      "inputType": "phone",
      "text": "Ваш номер телефона",
      "placeholder": "+7 ХХХ ХХХ-ХХ-ХХ",
      "required": true,
      "next": "applicant_illness"
    },
    {
      "id": "applicant_illness",
      "type": "input",
      "category": "details",
      "inputType": "text",
      "text": "Ваш диагноз",
      "placeholder": "Диагноз",
      "required": true,
      "next": "applicant_state"
    },
    {
      "id": "applicant_state",
      "type": "textarea",
      "category": "details",
      "text": "Опишите ваше текущее состояние здоровья и ограничения",
      "required": false,
      "next": "applicant_diagnosis_date"
    },
    {
      "id": "applicant_diagnosis_date",
      "type": "input",
      "category": "details",
      "inputType": "date",
      "text": "Когда был поставлен диагноз?",
      "required": false,
      "next": "applicant_tsr"
    },
    {
      "id": "applicant_tsr",
      "type": "select",
      "category": "details",
      "text": "Прописано ли ТСР в медзаключении или ИПРА?",
      "options": [
        { "label": "Прописано", "value": "yes", "next": "applicant_deadline" },
        { "label": "Не прописано", "value": "no", "next": "applicant_deadline" }
      ]
    },
    {
      "id": "applicant_deadline",
      "type": "input",
      "category": "details",
      "inputType": "text",
      "text": "Есть ли сроки, к которым важно получить помощь?",
      "required": false,
      "next": "prepare_documents"
    },

    {
      "id": "prepare_documents",
      "type": "info",
      "category": "documents",
      "image": "/images/main/prepare_docs.png",
      "text": "Теперь загрузим необходимые документы. Мы сами подскажем, какие именно нужны — в зависимости от вашего статуса. Приготовьте, пожалуйста, фото паспорта, СНИЛС и медицинских документов.",
      "actions": [
        { "label": "Далее", "action": "next", "next": "check_gosuslugi" }
      ]
    },
    {
      "id": "check_gosuslugi",
      "type": "select",
      "category": "documents",
      "text": "Подтверждена ли запись на Госуслугах?",
      "options": [
        { "label": "Да", "value": "yes", "next": "upload_doc" },
        { "label": "Нет", "value": "no", "next": "no_gosuslugi" }
      ]
    },
    {
      "id": "no_gosuslugi",
      "type": "info",
      "category": "documents",
      "image": "/images/main/no_gosuslugi.png",
      "text": "К сожалению, без подтверждённой учётной записи мы не сможем оформить заявку официально. Вы можете подтвердить свою учётную запись и вернуться к заполнению анкеты в любое удобное время.",
      "actions": [
        { "label": "В личный кабинет", "action": "__profile", "next": null }
      ]
    },
    {
      "id": "upload_doc",
      "type": "file",
      "category": "documents",
      "text": "Загрузите скан или фото паспорта (1-я страница)",
      "fileTypes": ["image/*", "application/pdf"],
      "required": true,
      "next": "completed"
    },

    {
      "id": "completed",
      "type": "info",
      "category": "documents",
      "image": "/images/main/final_check.png",
      "text": "Спасибо! Ваша анкета заполнена. Вы можете просмотреть её и подтвердить отправку.",
      "actions": [
        { "label": "Посмотреть анкету ещё раз", "action": "review", "next": "choose_section" },
        { "label": "Всё верно, отправить", "action": "submit", "next": "submitted" }
      ]
    },
    {
      "id": "choose_section",
      "type": "select",
      "category": "documents",
      "text": "Какой блок хотите проверить?",
      "options": [
        { "label": "Общая информация", "value": "general", "next": "review_general" },
        { "label": "Подробная информация", "value": "details", "next": "review_details" },
        { "label": "Документы", "value": "documents", "next": "review_documents" }
      ],
      "actions": [
        { "label": "Назад", "action": "back", "next": "completed" }
      ]
    },
    {
      "id": "review_general",
      "type": "info",
      "category": "documents",
      "image": "/images/main/review.png",
      "text": "Проверьте раздел 'Общая информация'.",
      "actions": [
        { "label": "Назад", "action": "back", "next": "choose_section" }
      ]
    },
    {
      "id": "review_details",
      "type": "info",
      "category": "documents",
      "image": "/images/main/review.png",
      "text": "Проверьте раздел 'Подробная информация'.",
      "actions": [
        { "label": "Назад", "action": "back", "next": "choose_section" }
      ]
    },
    {
      "id": "review_documents",
      "type": "info",
      "category": "documents",
      "image": "/images/main/review.png",
      "text": "Проверьте раздел 'Документы'.",
      "actions": [
        { "label": "Назад", "action": "back", "next": "choose_section" }
      ]
    },
    {
      "id": "submitted",
      "type": "info",
      "category": "documents",
      "image": "/images/main/submitted.png",
      "text": "✅ Ваша заявка принята! Спасибо, что обратились в фонд «Продвижение». Уже начали работу над вашей заявкой. Мы обязательно свяжемся с вами в ближайшее время.",
      "actions": [
        { "label": "В личный кабинет", "action": "__profile", "next": null }
      ]
    }
  ]
}
